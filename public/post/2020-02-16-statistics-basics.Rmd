---
title: Statistics Basics
author: Adrian Bandolon
date: '2020-02-16'
slug: statistics-basics
categories:
  - Data Science
  - Laboratory
  - R
  - Getting Started
tags:
  - R
  - Statistics
keywords:
  - tech
clearReading: true
thumbnailImage: /post/2020-02-16-statistics-basics_files/sundial.jpg
thumbnailImagePosition: left
autoThumbnailImage: no
---

Statistics is inherent in laboratory work since our primary product is data, yet so little emphasis is placed on its study. In this post we will cover basic statistical concepts that are widely used in the laboratory. We still study common probability distributions and in the process learn about measures of central tendency (i.e. mean, mode, median) and measures of dispersion (i.e. variance, standard deviation, coefficient of variation).

# Probability Distributions

A probability distribution is simply a description of the probability of a random phenomenon occuring. This description is often expressed as a mathematical function. The [probability density function](https://en.wikipedia.org/wiki/Probability_density_function) of a [normal distribution](https://en.wikipedia.org/wiki/Normal_distribution) for example is:

$$f(x) = \frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2} $$
where $\mu$ is the mean of the distribution and $\sigma$ is its standard deviation. If we are to plot this function it would look something like this:

```{r echo=FALSE, fig.width=2, fig.height=2, fig.align='center'}
library(ggplot2)
library(knitr)
library(dplyr)
library(kableExtra)

set.seed(1)
df <- data.frame(pf = 10*rnorm(1000))

p <- ggplot(df, aes(x = pf)) +
  geom_histogram(
    aes(y = ..density..),
    breaks = seq(-50, 50, by = 10),
    colour = "grey75",
    fill = "white"
  ) +
  stat_function(fun = dnorm, args = list(mean = mean(df$pf), sd = sd(df$pf))) +
  theme_linedraw()
p
```

Probability distributions generally are classified as either:

1. **Discrete probability distribution** -- describes outcome probabilities for events that can be counted or are discrete. Discrete data can be numeric (e.g. WBC count) or it can also be categorical (e.g. type of WBC--neutrophils, lymhocytes, monocytes, etc.). Examples of well-known discrete probability distributions is the *Poisson distribution* and the *Bernoulli distribution*.
2. **Continuous probability distribution** -- describes outcome probabilities of events that results from infinitely many possible values from a range of values without gaps.  This data can only be numeric. Most results we get in the chemistry department, like glucose and sodium levels are considered continuous. The most common continuous probability distribution not just in the lab and out in the world is the *Normal distribution* also known as *Gaussian Distribution*. In clinical chemistry we may encounter the *Log-normal distribution* also.

# Measures of Central Tendency

A measure of central tendency is a single value that attempts to summarize a dataset by identifying the central position within the set. They represent the most common value in a data set. 

The appropriate measure to use depends on the type and shape of the probability distribution you are working on. The mean or average is the most commonly encountered measure of central tendency in the lab. This is because we mostly work with the normal distribution. However, there are instances where the mean is not an appropriate measure to use, even when we are working with a normally distributed dataset.

## Mean (Arithmetic)
More commonly called an *average*. The arithmetic mean is determined by adding all the data points then dividing by the number of points. I specify the *arithmetic mean* because there are other methods for calculating a mean. The [*geometric mean*](https://en.wikipedia.org/wiki/Geometric_mean) for example is the *n*th root of the product of the data. The geometric mean is used in the INR calculation in coagulation.

The arithmetic mean is sensitive to *outliers*. An outlier is a value that is unusual compared to the rest of the dataset. In the figure below the last (right most data point) is an outlier. The red line is the mean without accounting for the outlier. The blue line is the mean if the outlier is taken into account. 

In cases where there are a significant number of outliers, a different measure would need to be utilized. An alternative to the mean is the median.

```{r, outlier}
# set seed to ensure "randomly" generated values
# are the same at each run
set.seed(123)

# generate ten random numbers with mean = 100 and sd = 10
seriesWithOutOutlier <- rnorm(10, mean = 100, sd = 10)

#mean without outlier
seriesWithOutOutlier_mean <- mean(seriesWithOutOutlier) 

# add an outlier to the series
seriesWithOutlier <- c(seriesWithOutOutlier,300)
```
```{r, outlierFig, echo=FALSE, fig.align='center', fig.width=6, fig.height=4}
# plot this data
plot(seriesWithOutlier, pch =21, bg = "grey50", cex= 1.5, ylab="")
abline(h=seriesWithOutOutlier_mean, col="red", lty = 2)
abline(h=mean(seriesWithOutlier), col = "blue", lty = 2)
```

## Median

If a series is sorted in order of magnitude, the median is the middle value. This works well if there are an  odd number of points. For an even number of points, the arithmetic mean of the two middle points will be used as the mean.

The median is less affected by outliers and skewed data. In the figure below, the median lies directly over (faint black line) the mean of the series where the outlier was not included.

```{r, medianPlot, echo=FALSE, fig.align='center', fig.width=6, fig.height=4}
# plot this data
plot(seriesWithOutlier, pch =21, bg = "grey50", cex= 1.5, ylab="")
abline(h=median(seriesWithOutlier), col = "black", lty = 1)
abline(h=seriesWithOutOutlier_mean, col="red", lty = 2)
abline(h=mean(seriesWithOutlier), col = "blue", lty = 2)
```

## Mode 

The mode the most frequent valuein a data series. Mode is most often used for categorical or discrete data. 

In the example below the mode is 50, because Neutrophils have the highest count.

```{r echo=FALSE}
cells <- c("Neutrophils", "Lymphocytes", "Monocytes", "Eosinophils", "Basophils")
counts <- c(50, 25, 9, 8, 8)

df <- as.data.frame(cbind(cells, counts))
colnames(df) <- c("Cell Type", "Count")

df %>% kable("html") %>% kable_styling(full_width = FALSE)
```

One of the issues of mode is that it is not always unique. We could for example have the same counts for neutrophils and lymphocytes when performing a differential.
